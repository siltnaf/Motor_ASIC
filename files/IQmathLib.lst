C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE IQMATHLIB
OBJECT MODULE PLACED IN .\OUTPUT\IQmathLib.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE SRC\IQmathLib.c OPTIMIZE(0,SPEED) REGFILE(.\OUTPUT\motor.ORC) BROWSE INT
                    -VECTOR(0X2000) INCDIR(.\INC) DEBUG OBJECTEXTEND CODE PRINT(.\files\IQmathLib.lst) TABS(2) OBJECT(.\OUTPUT\IQmathLib.obj)

line level    source

   1          /*
   2           * lib.c
   3           *  Copy Right (c) of JE
   4           *  Created on: 
   5           *      18 Sep 2018
   6           *  Author: 
   7           *      Ken
   8           *  Last Modified: 
   9           *     
  10           *  Description: 
  11           *      lib for JE8MCU
  12           *  History:
  13           *      ver 0.1 created by ken on 12 August 2016 
  14           *
  15           *    Use math table for fuctions of 
  16           *        sin, cos, inverse, sqrt, artan
  17           *        Park transform and Clark transform
  18           *
  19           *
  20           */
  21           
  22           /***************************************************
  23           * Includes
  24           */
  25          
  26          #include <intrins.h>   
  27          #include <absacc.h>
  28          #include "register.h"
  29          #include "IQmathLib.h"
  30          
  31          
  32          
  33          
  34          
  35          
  36          
  37          
  38          
  39          
  40          /*
  41           * @fn    sin16
  42           *
  43           * @brief sin16
  44           * 
  45           * @param none
  46           * sin(x) , where x is 
  47          
  48           *
  49           * @return  none
  50           */
  51          
  52          
  53          _iq _IQsin(_iq dat)
  54          {
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 2   

  55   1      volatile _iq angle_in,sin_out;
  56   1      volatile U32 table_input;
  57   1         
  58   1        angle_in=_IQabs(dat);
  59   1            
  60   1        //limit the search anlge to <360)
  61   1        
  62   1        while (angle_in>=_IQ(360.0))
  63   1            {
  64   2              angle_in-=_IQ(360.0);
  65   2            }
  66   1        
  67   1        // convert angle to data in sin table, angle =angle/360 * 512  or  =angle *64/45
  68   1            
  69   1        table_input=_IQint(angle_in<<6); 
  70   1        table_input/=45;  
  71   1       
  72   1        sin_out=XWORD[table_input+sin_table];
  73   1            sin_out=(sin_out<<16);                      //sin table is in Q15 format, it need to convert to Q31 first by shi
             -fting 16 bit to left
  74   1            sin_out=(sin_out) >> (31 - GLOBAL_Q);       //convert Q31 to global Q format
  75   1        
  76   1        if (dat<0) sin_out=-(sin_out);
  77   1       
  78   1      
  79   1        
  80   1      return sin_out ;
  81   1        
  82   1      }
  83          
  84          
  85          
  86          
  87          
  88          _iq _IQcos(_iq dat)
  89          {
  90   1        
  91   1      volatile _iq angle_in,cos_out;
  92   1      volatile U32 table_input;
  93   1         
  94   1      
  95   1        angle_in=_IQabs(dat);
  96   1            
  97   1        //limit the search anlge to <360)
  98   1        
  99   1        while (angle_in>=_IQ(360.0))
 100   1            {
 101   2              angle_in-=_IQ(360.0);
 102   2            }
 103   1        
 104   1        // convert angle to data in cos table, cos(angle) =sin(angle+90)
 105   1            
 106   1        table_input=_IQint(angle_in<<6); 
 107   1        table_input/=45;
 108   1      
 109   1       
 110   1        cos_out=XWORD[table_input+sin_table+128];            //cos is  lead sin by 90
 111   1       
 112   1        
 113   1        cos_out=(cos_out<<16);                      //sin table is in Q15 format, it need to convert to Q31 first by shift
             -ing 16 bit to left
 114   1        cos_out=(cos_out) >> (31 - GLOBAL_Q);       //convert Q31 to global Q format
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 3   

 115   1            
 116   1      return cos_out ;
 117   1        
 118   1      }
 119          
 120          
 121          
 122          
 123          
 124          
 125          
 126          _iq Normalize(_iq dat)              //normalize only work for positive value. it return error if the MD3_7
             -=1 
 127          {
 128   1       Long_Data LD;
 129   1       LD.Ldata =dat;
 130   1       MD0 = LD.ss1.Byte0;
 131   1       MD1 = LD.ss1.Byte1;
 132   1       MD2 = LD.ss1.Byte2;
 133   1       MD3 = LD.ss1.Byte3;
 134   1        
 135   1      
 136   1        
 137   1       ARCON = 0x00 ; // Start Normalizing
 138   1       while(MD3_7==0 ); //check MDU finish flag
 139   1        LD.ss1.Byte0=MD0;
 140   1        LD.ss1.Byte1=MD1;
 141   1        LD.ss1.Byte2=MD2;
 142   1        LD.ss1.Byte3=MD3;
 143   1       
 144   1         return LD.Ldata ;
 145   1      }
 146          
 147          
 148          _iq _IQinv(_iq dat)
 149          
 150          {
 151   1      volatile _iq inverse_in, inverse_out;
 152   1        volatile U32 table_input;
 153   1      volatile U8  index;
 154   1        
 155   1        inverse_in=_IQabs(dat);
 156   1        inverse_in=Normalize(inverse_in);   //convert to Q30 format
 157   1        index=(30-GLOBAL_Q-ARCON);
 158   1        inverse_in &=0x7fffffff;
 159   1        table_input=inverse_in>>22;
 160   1        inverse_out=XWORD[table_input+inverse_table]; 
 161   1        inverse_out=inverse_out<<16;
 162   1        inverse_out=(inverse_out) >> (31 - GLOBAL_Q);       //convert Q31 to global Q format
 163   1        
 164   1        if (index>=0)
 165   1        inverse_out=(inverse_out)>>index;
 166   1        else inverse_out=inverse_out<<index;
 167   1        
 168   1        if (dat<0) inverse_out=- inverse_out;
 169   1        
 170   1        
 171   1      return inverse_out;
 172   1      }
 173          
 174          
 175          _iq _IQsqrt(_iq dat)
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 4   

 176          
 177          {
 178   1      volatile _iq sqrt_in, sqrt_out;
 179   1        volatile U32 table_input;
 180   1      volatile U8  power;
 181   1        
 182   1        sqrt_in=_IQabs(dat);
 183   1        sqrt_in=Normalize(sqrt_in);   //convert to Q30 format
 184   1        power=(31-GLOBAL_Q-ARCON);
 185   1        
 186   1      
 187   1        if (power %2==0)                //check if the power is even or  odd value
 188   1          
 189   1        {
 190   2        sqrt_in &=0x7fffffff;
 191   2        table_input=(sqrt_in>>23)+128;  
 192   2          
 193   2          sqrt_out=XWORD[table_input+sqrt_table];
 194   2        }
 195   1        else
 196   1        {
 197   2          power=power+1;                             //if the power is odd value , divide t by 2
 198   2        
 199   2          table_input =sqrt_in>>24;             //square root in value is divided by 2 
 200   2          table_input &=0x0000007f;
 201   2          sqrt_out=XWORD[table_input+sqrt_table];
 202   2        }
 203   1        sqrt_out=sqrt_out<<16;
 204   1        sqrt_out=(sqrt_out) >> (30 - GLOBAL_Q);       //convert Q31 to global Q format
 205   1        
 206   1        if (power>=0)
 207   1        sqrt_out=(sqrt_out)<<(power>>1);
 208   1        else sqrt_out=sqrt_out>>(power>>1);
 209   1        
 210   1      
 211   1        
 212   1        
 213   1      return  sqrt_out;
 214   1      }
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 5   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION __IQ15sin (BEGIN)
                                           ; SOURCE LINE # 53
0000 8F00        R     MOV     dat+03H,R7
0002 8E00        R     MOV     dat+02H,R6
0004 8D00        R     MOV     dat+01H,R5
0006 8C00        R     MOV     dat,R4
                                           ; SOURCE LINE # 54
                                           ; SOURCE LINE # 58
0008 7F00              MOV     R7,#00H
000A 7E00              MOV     R6,#00H
000C 7D00              MOV     R5,#00H
000E 7C00              MOV     R4,#00H
0010 AB00        R     MOV     R3,dat+03H
0012 AA00        R     MOV     R2,dat+02H
0014 A900        R     MOV     R1,dat+01H
0016 A800        R     MOV     R0,dat
0018 C3                CLR     C
0019 120000      E     LCALL   ?C?SLCMP
001C 500D              JNC     ?C0001
001E AF00        R     MOV     R7,dat+03H
0020 AE00        R     MOV     R6,dat+02H
0022 AD00        R     MOV     R5,dat+01H
0024 AC00        R     MOV     R4,dat
0026 120000      E     LCALL   ?C?LNEG
0029 8008              SJMP    ?C0002
002B         ?C0001:
002B AF00        R     MOV     R7,dat+03H
002D AE00        R     MOV     R6,dat+02H
002F AD00        R     MOV     R5,dat+01H
0031 AC00        R     MOV     R4,dat
0033         ?C0002:
0033 8F00        R     MOV     angle_in+03H,R7
0035 8E00        R     MOV     angle_in+02H,R6
0037 8D00        R     MOV     angle_in+01H,R5
0039 8C00        R     MOV     angle_in,R4
003B         ?C0003:
                                           ; SOURCE LINE # 62
003B 7F00              MOV     R7,#00H
003D 7E00              MOV     R6,#00H
003F 7DB4              MOV     R5,#0B4H
0041 7C00              MOV     R4,#00H
0043 AB00        R     MOV     R3,angle_in+03H
0045 AA00        R     MOV     R2,angle_in+02H
0047 A900        R     MOV     R1,angle_in+01H
0049 A800        R     MOV     R0,angle_in
004B C3                CLR     C
004C 120000      E     LCALL   ?C?SLCMP
004F 401B              JC      ?C0004
                                           ; SOURCE LINE # 63
                                           ; SOURCE LINE # 64
0051 C3                CLR     C
0052 E500        R     MOV     A,angle_in+03H
0054 9400              SUBB    A,#00H
0056 F500        R     MOV     angle_in+03H,A
0058 E500        R     MOV     A,angle_in+02H
005A 9400              SUBB    A,#00H
005C F500        R     MOV     angle_in+02H,A
005E E500        R     MOV     A,angle_in+01H
0060 94B4              SUBB    A,#0B4H
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 6   

0062 F500        R     MOV     angle_in+01H,A
0064 E500        R     MOV     A,angle_in
0066 9400              SUBB    A,#00H
0068 F500        R     MOV     angle_in,A
                                           ; SOURCE LINE # 65
006A 80CF              SJMP    ?C0003
006C         ?C0004:
                                           ; SOURCE LINE # 69
006C AF00        R     MOV     R7,angle_in+03H
006E AE00        R     MOV     R6,angle_in+02H
0070 AD00        R     MOV     R5,angle_in+01H
0072 AC00        R     MOV     R4,angle_in
0074 7806              MOV     R0,#06H
0076 120000      E     LCALL   ?C?LSHL
0079 780F              MOV     R0,#0FH
007B 120000      E     LCALL   ?C?SLSHR
007E 8F00        R     MOV     table_input+03H,R7
0080 8E00        R     MOV     table_input+02H,R6
0082 8D00        R     MOV     table_input+01H,R5
0084 8C00        R     MOV     table_input,R4
                                           ; SOURCE LINE # 70
0086 AF00        R     MOV     R7,table_input+03H
0088 AE00        R     MOV     R6,table_input+02H
008A AD00        R     MOV     R5,table_input+01H
008C AC00        R     MOV     R4,table_input
008E 7B2D              MOV     R3,#02DH
0090 7A00              MOV     R2,#00H
0092 7900              MOV     R1,#00H
0094 7800              MOV     R0,#00H
0096 120000      E     LCALL   ?C?ULDIV
0099 8F00        R     MOV     table_input+03H,R7
009B 8E00        R     MOV     table_input+02H,R6
009D 8D00        R     MOV     table_input+01H,R5
009F 8C00        R     MOV     table_input,R4
                                           ; SOURCE LINE # 72
00A1 7F02              MOV     R7,#02H
00A3 7E00              MOV     R6,#00H
00A5 7D00              MOV     R5,#00H
00A7 7C00              MOV     R4,#00H
00A9 AB00        R     MOV     R3,table_input+03H
00AB AA00        R     MOV     R2,table_input+02H
00AD A900        R     MOV     R1,table_input+01H
00AF A800        R     MOV     R0,table_input
00B1 120000      E     LCALL   ?C?LMUL
00B4 8F82              MOV     DPL,R7
00B6 8E83              MOV     DPH,R6
00B8 E0                MOVX    A,@DPTR
00B9 FE                MOV     R6,A
00BA A3                INC     DPTR
00BB E0                MOVX    A,@DPTR
00BC FF                MOV     R7,A
00BD E4                CLR     A
00BE FC                MOV     R4,A
00BF FD                MOV     R5,A
00C0 8F00        R     MOV     sin_out+03H,R7
00C2 8E00        R     MOV     sin_out+02H,R6
00C4 8D00        R     MOV     sin_out+01H,R5
00C6 8C00        R     MOV     sin_out,R4
                                           ; SOURCE LINE # 73
00C8 AF00        R     MOV     R7,sin_out+03H
00CA AE00        R     MOV     R6,sin_out+02H
00CC AD00        R     MOV     R5,sin_out+01H
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 7   

00CE AC00        R     MOV     R4,sin_out
00D0 7810              MOV     R0,#010H
00D2 120000      E     LCALL   ?C?LSHL
00D5 8F00        R     MOV     sin_out+03H,R7
00D7 8E00        R     MOV     sin_out+02H,R6
00D9 8D00        R     MOV     sin_out+01H,R5
00DB 8C00        R     MOV     sin_out,R4
                                           ; SOURCE LINE # 74
00DD AF00        R     MOV     R7,sin_out+03H
00DF AE00        R     MOV     R6,sin_out+02H
00E1 AD00        R     MOV     R5,sin_out+01H
00E3 AC00        R     MOV     R4,sin_out
00E5 7810              MOV     R0,#010H
00E7 120000      E     LCALL   ?C?SLSHR
00EA 8F00        R     MOV     sin_out+03H,R7
00EC 8E00        R     MOV     sin_out+02H,R6
00EE 8D00        R     MOV     sin_out+01H,R5
00F0 8C00        R     MOV     sin_out,R4
                                           ; SOURCE LINE # 76
00F2 7F00              MOV     R7,#00H
00F4 7E00              MOV     R6,#00H
00F6 7D00              MOV     R5,#00H
00F8 7C00              MOV     R4,#00H
00FA AB00        R     MOV     R3,dat+03H
00FC AA00        R     MOV     R2,dat+02H
00FE A900        R     MOV     R1,dat+01H
0100 A800        R     MOV     R0,dat
0102 C3                CLR     C
0103 120000      E     LCALL   ?C?SLCMP
0106 5013              JNC     ?C0005
0108 AF00        R     MOV     R7,sin_out+03H
010A AE00        R     MOV     R6,sin_out+02H
010C AD00        R     MOV     R5,sin_out+01H
010E AC00        R     MOV     R4,sin_out
0110 120000      E     LCALL   ?C?LNEG
0113 8F00        R     MOV     sin_out+03H,R7
0115 8E00        R     MOV     sin_out+02H,R6
0117 8D00        R     MOV     sin_out+01H,R5
0119 8C00        R     MOV     sin_out,R4
011B         ?C0005:
                                           ; SOURCE LINE # 80
011B AF00        R     MOV     R7,sin_out+03H
011D AE00        R     MOV     R6,sin_out+02H
011F AD00        R     MOV     R5,sin_out+01H
0121 AC00        R     MOV     R4,sin_out
                                           ; SOURCE LINE # 82
0123         ?C0006:
0123 22                RET     
             ; FUNCTION __IQ15sin (END)

             ; FUNCTION __IQ15cos (BEGIN)
                                           ; SOURCE LINE # 88
0000 8F00        R     MOV     dat+03H,R7
0002 8E00        R     MOV     dat+02H,R6
0004 8D00        R     MOV     dat+01H,R5
0006 8C00        R     MOV     dat,R4
                                           ; SOURCE LINE # 89
                                           ; SOURCE LINE # 95
0008 7F00              MOV     R7,#00H
000A 7E00              MOV     R6,#00H
000C 7D00              MOV     R5,#00H
000E 7C00              MOV     R4,#00H
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 8   

0010 AB00        R     MOV     R3,dat+03H
0012 AA00        R     MOV     R2,dat+02H
0014 A900        R     MOV     R1,dat+01H
0016 A800        R     MOV     R0,dat
0018 C3                CLR     C
0019 120000      E     LCALL   ?C?SLCMP
001C 500D              JNC     ?C0007
001E AF00        R     MOV     R7,dat+03H
0020 AE00        R     MOV     R6,dat+02H
0022 AD00        R     MOV     R5,dat+01H
0024 AC00        R     MOV     R4,dat
0026 120000      E     LCALL   ?C?LNEG
0029 8008              SJMP    ?C0008
002B         ?C0007:
002B AF00        R     MOV     R7,dat+03H
002D AE00        R     MOV     R6,dat+02H
002F AD00        R     MOV     R5,dat+01H
0031 AC00        R     MOV     R4,dat
0033         ?C0008:
0033 8F00        R     MOV     angle_in+03H,R7
0035 8E00        R     MOV     angle_in+02H,R6
0037 8D00        R     MOV     angle_in+01H,R5
0039 8C00        R     MOV     angle_in,R4
003B         ?C0009:
                                           ; SOURCE LINE # 99
003B 7F00              MOV     R7,#00H
003D 7E00              MOV     R6,#00H
003F 7DB4              MOV     R5,#0B4H
0041 7C00              MOV     R4,#00H
0043 AB00        R     MOV     R3,angle_in+03H
0045 AA00        R     MOV     R2,angle_in+02H
0047 A900        R     MOV     R1,angle_in+01H
0049 A800        R     MOV     R0,angle_in
004B C3                CLR     C
004C 120000      E     LCALL   ?C?SLCMP
004F 401B              JC      ?C0010
                                           ; SOURCE LINE # 100
                                           ; SOURCE LINE # 101
0051 C3                CLR     C
0052 E500        R     MOV     A,angle_in+03H
0054 9400              SUBB    A,#00H
0056 F500        R     MOV     angle_in+03H,A
0058 E500        R     MOV     A,angle_in+02H
005A 9400              SUBB    A,#00H
005C F500        R     MOV     angle_in+02H,A
005E E500        R     MOV     A,angle_in+01H
0060 94B4              SUBB    A,#0B4H
0062 F500        R     MOV     angle_in+01H,A
0064 E500        R     MOV     A,angle_in
0066 9400              SUBB    A,#00H
0068 F500        R     MOV     angle_in,A
                                           ; SOURCE LINE # 102
006A 80CF              SJMP    ?C0009
006C         ?C0010:
                                           ; SOURCE LINE # 106
006C AF00        R     MOV     R7,angle_in+03H
006E AE00        R     MOV     R6,angle_in+02H
0070 AD00        R     MOV     R5,angle_in+01H
0072 AC00        R     MOV     R4,angle_in
0074 7806              MOV     R0,#06H
0076 120000      E     LCALL   ?C?LSHL
0079 780F              MOV     R0,#0FH
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 9   

007B 120000      E     LCALL   ?C?SLSHR
007E 8F00        R     MOV     table_input+03H,R7
0080 8E00        R     MOV     table_input+02H,R6
0082 8D00        R     MOV     table_input+01H,R5
0084 8C00        R     MOV     table_input,R4
                                           ; SOURCE LINE # 107
0086 AF00        R     MOV     R7,table_input+03H
0088 AE00        R     MOV     R6,table_input+02H
008A AD00        R     MOV     R5,table_input+01H
008C AC00        R     MOV     R4,table_input
008E 7B2D              MOV     R3,#02DH
0090 7A00              MOV     R2,#00H
0092 7900              MOV     R1,#00H
0094 7800              MOV     R0,#00H
0096 120000      E     LCALL   ?C?ULDIV
0099 8F00        R     MOV     table_input+03H,R7
009B 8E00        R     MOV     table_input+02H,R6
009D 8D00        R     MOV     table_input+01H,R5
009F 8C00        R     MOV     table_input,R4
                                           ; SOURCE LINE # 110
00A1 7F02              MOV     R7,#02H
00A3 7E00              MOV     R6,#00H
00A5 7D00              MOV     R5,#00H
00A7 7C00              MOV     R4,#00H
00A9 AB00        R     MOV     R3,table_input+03H
00AB AA00        R     MOV     R2,table_input+02H
00AD A900        R     MOV     R1,table_input+01H
00AF A800        R     MOV     R0,table_input
00B1 120000      E     LCALL   ?C?LMUL
00B4 E4                CLR     A
00B5 2F                ADD     A,R7
00B6 F582              MOV     DPL,A
00B8 7401              MOV     A,#01H
00BA 3E                ADDC    A,R6
00BB F583              MOV     DPH,A
00BD E0                MOVX    A,@DPTR
00BE FE                MOV     R6,A
00BF A3                INC     DPTR
00C0 E0                MOVX    A,@DPTR
00C1 FF                MOV     R7,A
00C2 E4                CLR     A
00C3 FC                MOV     R4,A
00C4 FD                MOV     R5,A
00C5 8F00        R     MOV     cos_out+03H,R7
00C7 8E00        R     MOV     cos_out+02H,R6
00C9 8D00        R     MOV     cos_out+01H,R5
00CB 8C00        R     MOV     cos_out,R4
                                           ; SOURCE LINE # 113
00CD AF00        R     MOV     R7,cos_out+03H
00CF AE00        R     MOV     R6,cos_out+02H
00D1 AD00        R     MOV     R5,cos_out+01H
00D3 AC00        R     MOV     R4,cos_out
00D5 7810              MOV     R0,#010H
00D7 120000      E     LCALL   ?C?LSHL
00DA 8F00        R     MOV     cos_out+03H,R7
00DC 8E00        R     MOV     cos_out+02H,R6
00DE 8D00        R     MOV     cos_out+01H,R5
00E0 8C00        R     MOV     cos_out,R4
                                           ; SOURCE LINE # 114
00E2 AF00        R     MOV     R7,cos_out+03H
00E4 AE00        R     MOV     R6,cos_out+02H
00E6 AD00        R     MOV     R5,cos_out+01H
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 10  

00E8 AC00        R     MOV     R4,cos_out
00EA 7810              MOV     R0,#010H
00EC 120000      E     LCALL   ?C?SLSHR
00EF 8F00        R     MOV     cos_out+03H,R7
00F1 8E00        R     MOV     cos_out+02H,R6
00F3 8D00        R     MOV     cos_out+01H,R5
00F5 8C00        R     MOV     cos_out,R4
                                           ; SOURCE LINE # 116
00F7 AF00        R     MOV     R7,cos_out+03H
00F9 AE00        R     MOV     R6,cos_out+02H
00FB AD00        R     MOV     R5,cos_out+01H
00FD AC00        R     MOV     R4,cos_out
                                           ; SOURCE LINE # 118
00FF         ?C0011:
00FF 22                RET     
             ; FUNCTION __IQ15cos (END)

             ; FUNCTION _Normalize (BEGIN)
                                           ; SOURCE LINE # 126
0000 8F00        R     MOV     dat+03H,R7
0002 8E00        R     MOV     dat+02H,R6
0004 8D00        R     MOV     dat+01H,R5
0006 8C00        R     MOV     dat,R4
                                           ; SOURCE LINE # 127
                                           ; SOURCE LINE # 129
0008 AF00        R     MOV     R7,dat+03H
000A AE00        R     MOV     R6,dat+02H
000C AD00        R     MOV     R5,dat+01H
000E AC00        R     MOV     R4,dat
0010 8F00        R     MOV     LD+03H,R7
0012 8E00        R     MOV     LD+02H,R6
0014 8D00        R     MOV     LD+01H,R5
0016 8C00        R     MOV     LD,R4
                                           ; SOURCE LINE # 130
0018 8500E9      R     MOV     MD0,LD+03H
                                           ; SOURCE LINE # 131
001B 8500EA      R     MOV     MD1,LD+02H
                                           ; SOURCE LINE # 132
001E 8500EB      R     MOV     MD2,LD+01H
                                           ; SOURCE LINE # 133
0021 8500EC      R     MOV     MD3,LD
                                           ; SOURCE LINE # 137
0024 75EF00            MOV     ARCON,#00H
0027         ?C0012:
                                           ; SOURCE LINE # 138
0027 E5EC              MOV     A,MD3
0029 30E704            JNB     ACC.7,?C0014
002C 7F01              MOV     R7,#01H
002E 8002              SJMP    ?C0015
0030         ?C0014:
0030 7F00              MOV     R7,#00H
0032         ?C0015:
0032 EF                MOV     A,R7
0033 60F2              JZ      ?C0012
0035         ?C0013:
                                           ; SOURCE LINE # 139
0035 85E900      R     MOV     LD+03H,MD0
                                           ; SOURCE LINE # 140
0038 85EA00      R     MOV     LD+02H,MD1
                                           ; SOURCE LINE # 141
003B 85EB00      R     MOV     LD+01H,MD2
                                           ; SOURCE LINE # 142
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 11  

003E 85EC00      R     MOV     LD,MD3
                                           ; SOURCE LINE # 144
0041 AF00        R     MOV     R7,LD+03H
0043 AE00        R     MOV     R6,LD+02H
0045 AD00        R     MOV     R5,LD+01H
0047 AC00        R     MOV     R4,LD
                                           ; SOURCE LINE # 145
0049         ?C0016:
0049 22                RET     
             ; FUNCTION _Normalize (END)

             ; FUNCTION __IQ15inv (BEGIN)
                                           ; SOURCE LINE # 148
0000 8F00        R     MOV     dat+03H,R7
0002 8E00        R     MOV     dat+02H,R6
0004 8D00        R     MOV     dat+01H,R5
0006 8C00        R     MOV     dat,R4
                                           ; SOURCE LINE # 150
                                           ; SOURCE LINE # 155
0008 7F00              MOV     R7,#00H
000A 7E00              MOV     R6,#00H
000C 7D00              MOV     R5,#00H
000E 7C00              MOV     R4,#00H
0010 AB00        R     MOV     R3,dat+03H
0012 AA00        R     MOV     R2,dat+02H
0014 A900        R     MOV     R1,dat+01H
0016 A800        R     MOV     R0,dat
0018 C3                CLR     C
0019 120000      E     LCALL   ?C?SLCMP
001C 500D              JNC     ?C0017
001E AF00        R     MOV     R7,dat+03H
0020 AE00        R     MOV     R6,dat+02H
0022 AD00        R     MOV     R5,dat+01H
0024 AC00        R     MOV     R4,dat
0026 120000      E     LCALL   ?C?LNEG
0029 8008              SJMP    ?C0018
002B         ?C0017:
002B AF00        R     MOV     R7,dat+03H
002D AE00        R     MOV     R6,dat+02H
002F AD00        R     MOV     R5,dat+01H
0031 AC00        R     MOV     R4,dat
0033         ?C0018:
0033 8F00        R     MOV     inverse_in+03H,R7
0035 8E00        R     MOV     inverse_in+02H,R6
0037 8D00        R     MOV     inverse_in+01H,R5
0039 8C00        R     MOV     inverse_in,R4
                                           ; SOURCE LINE # 156
003B AF00        R     MOV     R7,inverse_in+03H
003D AE00        R     MOV     R6,inverse_in+02H
003F AD00        R     MOV     R5,inverse_in+01H
0041 AC00        R     MOV     R4,inverse_in
0043 120000      R     LCALL   _Normalize
0046 8F00        R     MOV     inverse_in+03H,R7
0048 8E00        R     MOV     inverse_in+02H,R6
004A 8D00        R     MOV     inverse_in+01H,R5
004C 8C00        R     MOV     inverse_in,R4
                                           ; SOURCE LINE # 157
004E C3                CLR     C
004F 740F              MOV     A,#0FH
0051 95EF              SUBB    A,ARCON
0053 F500        R     MOV     index,A
                                           ; SOURCE LINE # 158
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 12  

0055 E500        R     MOV     A,inverse_in+03H
0057 54FF              ANL     A,#0FFH
0059 F500        R     MOV     inverse_in+03H,A
005B E500        R     MOV     A,inverse_in+02H
005D 54FF              ANL     A,#0FFH
005F F500        R     MOV     inverse_in+02H,A
0061 E500        R     MOV     A,inverse_in+01H
0063 54FF              ANL     A,#0FFH
0065 F500        R     MOV     inverse_in+01H,A
0067 E500        R     MOV     A,inverse_in
0069 547F              ANL     A,#07FH
006B F500        R     MOV     inverse_in,A
                                           ; SOURCE LINE # 159
006D AF00        R     MOV     R7,inverse_in+03H
006F AE00        R     MOV     R6,inverse_in+02H
0071 AD00        R     MOV     R5,inverse_in+01H
0073 AC00        R     MOV     R4,inverse_in
0075 7816              MOV     R0,#016H
0077 120000      E     LCALL   ?C?SLSHR
007A 8F00        R     MOV     table_input+03H,R7
007C 8E00        R     MOV     table_input+02H,R6
007E 8D00        R     MOV     table_input+01H,R5
0080 8C00        R     MOV     table_input,R4
                                           ; SOURCE LINE # 160
0082 7F02              MOV     R7,#02H
0084 7E00              MOV     R6,#00H
0086 7D00              MOV     R5,#00H
0088 7C00              MOV     R4,#00H
008A AB00        R     MOV     R3,table_input+03H
008C AA00        R     MOV     R2,table_input+02H
008E A900        R     MOV     R1,table_input+01H
0090 A800        R     MOV     R0,table_input
0092 120000      E     LCALL   ?C?LMUL
0095 E4                CLR     A
0096 2F                ADD     A,R7
0097 F582              MOV     DPL,A
0099 7404              MOV     A,#04H
009B 3E                ADDC    A,R6
009C F583              MOV     DPH,A
009E E0                MOVX    A,@DPTR
009F FE                MOV     R6,A
00A0 A3                INC     DPTR
00A1 E0                MOVX    A,@DPTR
00A2 FF                MOV     R7,A
00A3 E4                CLR     A
00A4 FC                MOV     R4,A
00A5 FD                MOV     R5,A
00A6 8F00        R     MOV     inverse_out+03H,R7
00A8 8E00        R     MOV     inverse_out+02H,R6
00AA 8D00        R     MOV     inverse_out+01H,R5
00AC 8C00        R     MOV     inverse_out,R4
                                           ; SOURCE LINE # 161
00AE AF00        R     MOV     R7,inverse_out+03H
00B0 AE00        R     MOV     R6,inverse_out+02H
00B2 AD00        R     MOV     R5,inverse_out+01H
00B4 AC00        R     MOV     R4,inverse_out
00B6 7810              MOV     R0,#010H
00B8 120000      E     LCALL   ?C?LSHL
00BB 8F00        R     MOV     inverse_out+03H,R7
00BD 8E00        R     MOV     inverse_out+02H,R6
00BF 8D00        R     MOV     inverse_out+01H,R5
00C1 8C00        R     MOV     inverse_out,R4
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 13  

                                           ; SOURCE LINE # 162
00C3 AF00        R     MOV     R7,inverse_out+03H
00C5 AE00        R     MOV     R6,inverse_out+02H
00C7 AD00        R     MOV     R5,inverse_out+01H
00C9 AC00        R     MOV     R4,inverse_out
00CB 7810              MOV     R0,#010H
00CD 120000      E     LCALL   ?C?SLSHR
00D0 8F00        R     MOV     inverse_out+03H,R7
00D2 8E00        R     MOV     inverse_out+02H,R6
00D4 8D00        R     MOV     inverse_out+01H,R5
00D6 8C00        R     MOV     inverse_out,R4
                                           ; SOURCE LINE # 164
00D8 E500        R     MOV     A,index
00DA C3                CLR     C
00DB 9400              SUBB    A,#00H
00DD 4019              JC      ?C0019
                                           ; SOURCE LINE # 165
00DF AF00        R     MOV     R7,inverse_out+03H
00E1 AE00        R     MOV     R6,inverse_out+02H
00E3 AD00        R     MOV     R5,inverse_out+01H
00E5 AC00        R     MOV     R4,inverse_out
00E7 A900        R     MOV     R1,index
00E9 A801              MOV     R0,AR1
00EB 120000      E     LCALL   ?C?SLSHR
00EE 8F00        R     MOV     inverse_out+03H,R7
00F0 8E00        R     MOV     inverse_out+02H,R6
00F2 8D00        R     MOV     inverse_out+01H,R5
00F4 8C00        R     MOV     inverse_out,R4
00F6 8017              SJMP    ?C0020
00F8         ?C0019:
                                           ; SOURCE LINE # 166
00F8 AF00        R     MOV     R7,inverse_out+03H
00FA AE00        R     MOV     R6,inverse_out+02H
00FC AD00        R     MOV     R5,inverse_out+01H
00FE AC00        R     MOV     R4,inverse_out
0100 A900        R     MOV     R1,index
0102 A801              MOV     R0,AR1
0104 120000      E     LCALL   ?C?LSHL
0107 8F00        R     MOV     inverse_out+03H,R7
0109 8E00        R     MOV     inverse_out+02H,R6
010B 8D00        R     MOV     inverse_out+01H,R5
010D 8C00        R     MOV     inverse_out,R4
010F         ?C0020:
                                           ; SOURCE LINE # 168
010F 7F00              MOV     R7,#00H
0111 7E00              MOV     R6,#00H
0113 7D00              MOV     R5,#00H
0115 7C00              MOV     R4,#00H
0117 AB00        R     MOV     R3,dat+03H
0119 AA00        R     MOV     R2,dat+02H
011B A900        R     MOV     R1,dat+01H
011D A800        R     MOV     R0,dat
011F C3                CLR     C
0120 120000      E     LCALL   ?C?SLCMP
0123 5013              JNC     ?C0021
0125 AF00        R     MOV     R7,inverse_out+03H
0127 AE00        R     MOV     R6,inverse_out+02H
0129 AD00        R     MOV     R5,inverse_out+01H
012B AC00        R     MOV     R4,inverse_out
012D 120000      E     LCALL   ?C?LNEG
0130 8F00        R     MOV     inverse_out+03H,R7
0132 8E00        R     MOV     inverse_out+02H,R6
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 14  

0134 8D00        R     MOV     inverse_out+01H,R5
0136 8C00        R     MOV     inverse_out,R4
0138         ?C0021:
                                           ; SOURCE LINE # 171
0138 AF00        R     MOV     R7,inverse_out+03H
013A AE00        R     MOV     R6,inverse_out+02H
013C AD00        R     MOV     R5,inverse_out+01H
013E AC00        R     MOV     R4,inverse_out
                                           ; SOURCE LINE # 172
0140         ?C0022:
0140 22                RET     
             ; FUNCTION __IQ15inv (END)

             ; FUNCTION __IQ15sqrt (BEGIN)
                                           ; SOURCE LINE # 175
0000 8F00        R     MOV     dat+03H,R7
0002 8E00        R     MOV     dat+02H,R6
0004 8D00        R     MOV     dat+01H,R5
0006 8C00        R     MOV     dat,R4
                                           ; SOURCE LINE # 177
                                           ; SOURCE LINE # 182
0008 7F00              MOV     R7,#00H
000A 7E00              MOV     R6,#00H
000C 7D00              MOV     R5,#00H
000E 7C00              MOV     R4,#00H
0010 AB00        R     MOV     R3,dat+03H
0012 AA00        R     MOV     R2,dat+02H
0014 A900        R     MOV     R1,dat+01H
0016 A800        R     MOV     R0,dat
0018 C3                CLR     C
0019 120000      E     LCALL   ?C?SLCMP
001C 500D              JNC     ?C0023
001E AF00        R     MOV     R7,dat+03H
0020 AE00        R     MOV     R6,dat+02H
0022 AD00        R     MOV     R5,dat+01H
0024 AC00        R     MOV     R4,dat
0026 120000      E     LCALL   ?C?LNEG
0029 8008              SJMP    ?C0024
002B         ?C0023:
002B AF00        R     MOV     R7,dat+03H
002D AE00        R     MOV     R6,dat+02H
002F AD00        R     MOV     R5,dat+01H
0031 AC00        R     MOV     R4,dat
0033         ?C0024:
0033 8F00        R     MOV     sqrt_in+03H,R7
0035 8E00        R     MOV     sqrt_in+02H,R6
0037 8D00        R     MOV     sqrt_in+01H,R5
0039 8C00        R     MOV     sqrt_in,R4
                                           ; SOURCE LINE # 183
003B AF00        R     MOV     R7,sqrt_in+03H
003D AE00        R     MOV     R6,sqrt_in+02H
003F AD00        R     MOV     R5,sqrt_in+01H
0041 AC00        R     MOV     R4,sqrt_in
0043 120000      R     LCALL   _Normalize
0046 8F00        R     MOV     sqrt_in+03H,R7
0048 8E00        R     MOV     sqrt_in+02H,R6
004A 8D00        R     MOV     sqrt_in+01H,R5
004C 8C00        R     MOV     sqrt_in,R4
                                           ; SOURCE LINE # 184
004E C3                CLR     C
004F 7410              MOV     A,#010H
0051 95EF              SUBB    A,ARCON
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 15  

0053 F500        R     MOV     power,A
                                           ; SOURCE LINE # 187
0055 E500        R     MOV     A,power
0057 20E06B            JB      ACC.0,?C0025
                                           ; SOURCE LINE # 189
                                           ; SOURCE LINE # 190
005A E500        R     MOV     A,sqrt_in+03H
005C 54FF              ANL     A,#0FFH
005E F500        R     MOV     sqrt_in+03H,A
0060 E500        R     MOV     A,sqrt_in+02H
0062 54FF              ANL     A,#0FFH
0064 F500        R     MOV     sqrt_in+02H,A
0066 E500        R     MOV     A,sqrt_in+01H
0068 54FF              ANL     A,#0FFH
006A F500        R     MOV     sqrt_in+01H,A
006C E500        R     MOV     A,sqrt_in
006E 547F              ANL     A,#07FH
0070 F500        R     MOV     sqrt_in,A
                                           ; SOURCE LINE # 191
0072 AF00        R     MOV     R7,sqrt_in+03H
0074 AE00        R     MOV     R6,sqrt_in+02H
0076 AD00        R     MOV     R5,sqrt_in+01H
0078 AC00        R     MOV     R4,sqrt_in
007A 7817              MOV     R0,#017H
007C 120000      E     LCALL   ?C?SLSHR
007F EF                MOV     A,R7
0080 2480              ADD     A,#080H
0082 FF                MOV     R7,A
0083 EE                MOV     A,R6
0084 3400              ADDC    A,#00H
0086 FE                MOV     R6,A
0087 ED                MOV     A,R5
0088 3400              ADDC    A,#00H
008A FD                MOV     R5,A
008B EC                MOV     A,R4
008C 3400              ADDC    A,#00H
008E FC                MOV     R4,A
008F 8F00        R     MOV     table_input+03H,R7
0091 8E00        R     MOV     table_input+02H,R6
0093 8D00        R     MOV     table_input+01H,R5
0095 8C00        R     MOV     table_input,R4
                                           ; SOURCE LINE # 193
0097 7F02              MOV     R7,#02H
0099 7E00              MOV     R6,#00H
009B 7D00              MOV     R5,#00H
009D 7C00              MOV     R4,#00H
009F AB00        R     MOV     R3,table_input+03H
00A1 AA00        R     MOV     R2,table_input+02H
00A3 A900        R     MOV     R1,table_input+01H
00A5 A800        R     MOV     R0,table_input
00A7 120000      E     LCALL   ?C?LMUL
00AA E4                CLR     A
00AB 2F                ADD     A,R7
00AC F582              MOV     DPL,A
00AE 7408              MOV     A,#08H
00B0 3E                ADDC    A,R6
00B1 F583              MOV     DPH,A
00B3 E0                MOVX    A,@DPTR
00B4 FE                MOV     R6,A
00B5 A3                INC     DPTR
00B6 E0                MOVX    A,@DPTR
00B7 FF                MOV     R7,A
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 16  

00B8 E4                CLR     A
00B9 FC                MOV     R4,A
00BA FD                MOV     R5,A
00BB 8F00        R     MOV     sqrt_out+03H,R7
00BD 8E00        R     MOV     sqrt_out+02H,R6
00BF 8D00        R     MOV     sqrt_out+01H,R5
00C1 8C00        R     MOV     sqrt_out,R4
                                           ; SOURCE LINE # 194
00C3 805B              SJMP    ?C0026
00C5         ?C0025:
                                           ; SOURCE LINE # 196
                                           ; SOURCE LINE # 197
00C5 0500        R     INC     power
                                           ; SOURCE LINE # 199
00C7 AF00        R     MOV     R7,sqrt_in+03H
00C9 AE00        R     MOV     R6,sqrt_in+02H
00CB AD00        R     MOV     R5,sqrt_in+01H
00CD AC00        R     MOV     R4,sqrt_in
00CF 7818              MOV     R0,#018H
00D1 120000      E     LCALL   ?C?SLSHR
00D4 8F00        R     MOV     table_input+03H,R7
00D6 8E00        R     MOV     table_input+02H,R6
00D8 8D00        R     MOV     table_input+01H,R5
00DA 8C00        R     MOV     table_input,R4
                                           ; SOURCE LINE # 200
00DC E500        R     MOV     A,table_input+03H
00DE 547F              ANL     A,#07FH
00E0 F500        R     MOV     table_input+03H,A
00E2 E500        R     MOV     A,table_input+02H
00E4 5400              ANL     A,#00H
00E6 F500        R     MOV     table_input+02H,A
00E8 E500        R     MOV     A,table_input+01H
00EA 5400              ANL     A,#00H
00EC F500        R     MOV     table_input+01H,A
00EE E500        R     MOV     A,table_input
00F0 5400              ANL     A,#00H
00F2 F500        R     MOV     table_input,A
                                           ; SOURCE LINE # 201
00F4 7F02              MOV     R7,#02H
00F6 7E00              MOV     R6,#00H
00F8 7D00              MOV     R5,#00H
00FA 7C00              MOV     R4,#00H
00FC AB00        R     MOV     R3,table_input+03H
00FE AA00        R     MOV     R2,table_input+02H
0100 A900        R     MOV     R1,table_input+01H
0102 A800        R     MOV     R0,table_input
0104 120000      E     LCALL   ?C?LMUL
0107 E4                CLR     A
0108 2F                ADD     A,R7
0109 F582              MOV     DPL,A
010B 7408              MOV     A,#08H
010D 3E                ADDC    A,R6
010E F583              MOV     DPH,A
0110 E0                MOVX    A,@DPTR
0111 FE                MOV     R6,A
0112 A3                INC     DPTR
0113 E0                MOVX    A,@DPTR
0114 FF                MOV     R7,A
0115 E4                CLR     A
0116 FC                MOV     R4,A
0117 FD                MOV     R5,A
0118 8F00        R     MOV     sqrt_out+03H,R7
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 17  

011A 8E00        R     MOV     sqrt_out+02H,R6
011C 8D00        R     MOV     sqrt_out+01H,R5
011E 8C00        R     MOV     sqrt_out,R4
                                           ; SOURCE LINE # 202
0120         ?C0026:
                                           ; SOURCE LINE # 203
0120 AF00        R     MOV     R7,sqrt_out+03H
0122 AE00        R     MOV     R6,sqrt_out+02H
0124 AD00        R     MOV     R5,sqrt_out+01H
0126 AC00        R     MOV     R4,sqrt_out
0128 7810              MOV     R0,#010H
012A 120000      E     LCALL   ?C?LSHL
012D 8F00        R     MOV     sqrt_out+03H,R7
012F 8E00        R     MOV     sqrt_out+02H,R6
0131 8D00        R     MOV     sqrt_out+01H,R5
0133 8C00        R     MOV     sqrt_out,R4
                                           ; SOURCE LINE # 204
0135 AF00        R     MOV     R7,sqrt_out+03H
0137 AE00        R     MOV     R6,sqrt_out+02H
0139 AD00        R     MOV     R5,sqrt_out+01H
013B AC00        R     MOV     R4,sqrt_out
013D 780F              MOV     R0,#0FH
013F 120000      E     LCALL   ?C?SLSHR
0142 8F00        R     MOV     sqrt_out+03H,R7
0144 8E00        R     MOV     sqrt_out+02H,R6
0146 8D00        R     MOV     sqrt_out+01H,R5
0148 8C00        R     MOV     sqrt_out,R4
                                           ; SOURCE LINE # 206
014A E500        R     MOV     A,power
014C C3                CLR     C
014D 9400              SUBB    A,#00H
014F 401C              JC      ?C0027
                                           ; SOURCE LINE # 207
0151 AF00        R     MOV     R7,sqrt_out+03H
0153 AE00        R     MOV     R6,sqrt_out+02H
0155 AD00        R     MOV     R5,sqrt_out+01H
0157 AC00        R     MOV     R4,sqrt_out
0159 E500        R     MOV     A,power
015B C3                CLR     C
015C 13                RRC     A
015D F9                MOV     R1,A
015E A801              MOV     R0,AR1
0160 120000      E     LCALL   ?C?LSHL
0163 8F00        R     MOV     sqrt_out+03H,R7
0165 8E00        R     MOV     sqrt_out+02H,R6
0167 8D00        R     MOV     sqrt_out+01H,R5
0169 8C00        R     MOV     sqrt_out,R4
016B 801A              SJMP    ?C0028
016D         ?C0027:
                                           ; SOURCE LINE # 208
016D AF00        R     MOV     R7,sqrt_out+03H
016F AE00        R     MOV     R6,sqrt_out+02H
0171 AD00        R     MOV     R5,sqrt_out+01H
0173 AC00        R     MOV     R4,sqrt_out
0175 E500        R     MOV     A,power
0177 C3                CLR     C
0178 13                RRC     A
0179 F9                MOV     R1,A
017A A801              MOV     R0,AR1
017C 120000      E     LCALL   ?C?SLSHR
017F 8F00        R     MOV     sqrt_out+03H,R7
0181 8E00        R     MOV     sqrt_out+02H,R6
C51 COMPILER V9.54   IQMATHLIB                                                             11/23/2018 17:01:52 PAGE 18  

0183 8D00        R     MOV     sqrt_out+01H,R5
0185 8C00        R     MOV     sqrt_out,R4
0187         ?C0028:
                                           ; SOURCE LINE # 213
0187 AF00        R     MOV     R7,sqrt_out+03H
0189 AE00        R     MOV     R6,sqrt_out+02H
018B AD00        R     MOV     R5,sqrt_out+01H
018D AC00        R     MOV     R4,sqrt_out
                                           ; SOURCE LINE # 214
018F         ?C0029:
018F 22                RET     
             ; FUNCTION __IQ15sqrt (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1343    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     74    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
